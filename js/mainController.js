!function(t){"use strict";t.module("public-transport").controller("mainController",["$scope","$http","stopService",function(t,a,n){function i(t){var a=t.split(":"),n=parseInt(a[0]),i=parseInt(a[1]),e=parseInt(a[2]);return 60*n*60+60*i+e}function e(t,a){var n=i(t),e=i(a),r=(e-n)/60;return r.toString()+" min"}function r(){t.trips=[];for(var a=[],n=[],i=0;i<t.caltrainData.stopTimes.length;i++)parseInt(t.caltrainData.stopTimes[i].stop_id)!==parseInt(t.startingStation.stop_id)&&parseInt(t.caltrainData.stopTimes[i].stop_id)!==parseInt(t.startingStation.stop_id)+1||a.push(t.caltrainData.stopTimes[i]),parseInt(t.caltrainData.stopTimes[i].stop_id)!==parseInt(t.endingStation.stop_id)&&parseInt(t.caltrainData.stopTimes[i].stop_id)!==parseInt(t.endingStation.stop_id)+1||n.push(t.caltrainData.stopTimes[i]);for(var r=0;r<a.length;r++)for(var s=0;s<n.length;s++)if(a[r].trip_id===n[s].trip_id&&parseInt(a[r].stop_sequence)<parseInt(n[s].stop_sequence)){var o=a[r],p=n[s],c=o.departure_time,d=p.arrival_time,l=o.trip_id,u=t.caltrainData.trips[l].route_id,S=t.caltrainData.trips[l].service_id,_="";S.includes("Weekday")?_="Weekday":S.includes("Sunday")?_="Sunday":S.includes("Saturday")&&(_="Saturday");var g=t.caltrainData.routes[u].route_long_name,m=e(c,d);t.trips.push({serviceType:_,routeName:g,departureTime:c,arrivalTime:d,tripTime:m})}}t.stops=[],t.startingStationSelected=!1,t.endingStationSelected=!1,t.caltrainData={},n.getAll().success(function(a){t.caltrainData=a,$.each(a.stops,function(a,n){var i=!0;$.each(t.stops,function(t,a){a.parent_station!==n.parent_station&&a.stop_name!==n.stop_name||(i=!1)}),i&&t.stops.push(n)})}),t.startingStation={stop_id:""},t.endingStation={stop_id:""},t.getStopTimesForStartingStation=function(){t.startingStationSelected=!0,t.endingStationSelected===!0&&r()},t.getStopTimesForEndingStation=function(){t.endingStationSelected=!0,t.startingStationSelected===!0&&r()};var s=this;return s}])}(window.angular);